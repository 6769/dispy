<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
  <head> 
    <meta http-equiv="content-type" content="text/html; charset=utf-8" /> 
    <meta name="description" content="Python module for distributing computations across multiple processors on a single machine, among many machines in a cluster, grid or cloud. The computations can be standalone programs or python functions." /> 
    <meta name="keywords" content="dispy, python, parallel processing, distributed computing, cluster computing" /> 
    <title> 
      SourceForge.net: dispy - Project Web Hosting - Open Source Software
    </title> 

<link rel="stylesheet" type="text/css" href="style.css" />
 
  </head> 
  <body> 
    <small><a href="http://sourceforge.net/projects/dispy/">dispy</a>:  Project Web Hosting - Open Source Software</small> 
    <h1>dispy</h1> 
    <div id="projectinfo"> 
      <div id="menu">
	<ul>
        <li><a href="index.html">Project Page</a></li> 
        <li><a href="dispy.html">dispy</a></li> 
        <li><a href="dispynode.html">dispynode</a></li> 
        <li><a href="dispyscheduler.html">dispyscheduler</a></li> 
        <li><a href="dispynetrelay.html">dispynetrelay</a></li>
	</ul>
	<hr />
	<ul>
        <li><a href="http://sourceforge.net/projects/dispy/files">Download dispy</a></li> 
        <li><a href="http://sourceforge.net/projects/dispy/">Project details</a></li> 
        <li><a href="http://sourceforge.net/projects/dispy/support">Get support</a></li>
	</ul>
      </div> 
      <div id="content"> 
        <h2> 
          asyncoro
        </h2> 
<p>
  asyncoro, available
  in <a href="http://sourceforge.net/projects/dispy/files/discopy">discopy</a>
  package, is a framework for developing (concurrent) programs with
  asynchronous sockets and coroutines. The coroutines should use
  'yield' with tasks that take time to complete, such as waiting for
  I/O completion, or sleep. Each yield statement gives control to
  asyncoro's scheduler, which interleaves executions of coroutines,
  similar to the way an operating system executes multiple
  processes. asyncoro includes polling mechanisms epoll,
  kqueue and poll for high performance and scalability.

  discopy is an implementation of dispy using asyncoro
  framework. asyncoro can be used independently of dispy/discopy.
  </p>

<p>
AsynCoro and associated classes in asyncoro.py file provide framework
for developing programs with coroutines and asynchronous I/O for
sockets. The programs developed with asyncoro will have same logic as
python progorams with synchronous sockets and threads, except for
converting sockets to asynchronous model with AsynCoroSocket class,
'yield' when waiting for completion of tasks (i.e., socket operations,
sleep and waiting on CoroCondition) and using CoroLock, CoroCondition
in place of thread locking. Tehcnically, CoroLock is not needed (as
there is no forced preemption with coroutines and at most one
coroutine is executing at anytime), but if one wants to maintain same
program for both synchronous and asynchronous models, it would be
simple to interchange threading.Lock and CoroLock, threading.Condition
and CoroCondition, and a few syntactic changes.
</p>

<p>
For example, a simple tcp server with asyncoro looks like:
</p>
<code>def process(sock, coro=None):
    sock = AsynCoroSocket(sock)
    # get (exactly) 4MB of data, for example, and let other coroutines
    # (process methods, in this case) execute in the meantime
    data = yield sock.read(4096*1024)
    ...
    yield sock.write(reply)
    sock.close()

if __name__ == '__main__':
    host, port = '', 3456
    # start asyncoro scheduler before creating coroutines
    asyncoro = AsynCoro()
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.bind((host, port))
    sock.listen(128)
    while True:
        conn, addr = sock.accept()
        Coro(process, conn)
</code>

<p>
Here we mixed synchronous sockets in server loop and asynchronous
sockets in the 'process' method for illustration. The server does not
do any processing, so the loop can quickly accept connections. Each
request is processed in a separate coroutine. A coroutine method must
have 'coro=None' default argument. The coroutine builder Coro will set
coro argument with the Coro instance, which is used for calling
methods in Coro class.
</p>

<p>When it is necessary to suspend/sleep, a coro (instance of Coro)
should use coro.sleep(timeout=None) instead of time.sleep. A
coro.sleep allows other coros to execute during sleep, whereas
time.sleep blocks other coros. If timeout is None, some other coro or
program thread must wake it up. If timetout is a number, the coro
sleeps for that many seconds (or fractions of second) unless someone
else wakes it up before. A sleeping coro can be woken up/resumed with
coro.resume(update=None). The update value is 'sent' to the sleeping
coro, so that 'yield' that caused it to suspend will receive
update. Thus, if coro1 suspends with <tt>news = yield
coro1.sleep()</tt> and later, another coro, coro2, can wake it up
with <tt>coro1.wakeup('rained')</tt>. This sets 'news' to 'rained' in
coro1 and coro1 resumes execution.  The update can be any python
object. asyncoro framework requires that 'resume' called on only
currently sleeping coro(s). Otherwise, the update is ignored (and a
warning is given). If necessary, cooperating coros can use a
CoroCondition to signal when a coro is going to sleep. Note that
'sleep' must be used with 'yield'; otherwise, entire coroutine
suite will be locked up.
  </p>

<p>
With python's coroutines, a coroutine stops at each yield statement
and proceeds only after next iteration is asked for (with 'next' or
'send' methods). With asyncoro, yield is used to convey to the
scheduler that the statement associated with yield is time consuming
so the scheduler can run other coroutines while waiting for that task
to complete. Thus, asyncoro coroutines continue execution (interleaved
with other coroutines) after each yield, unless it has been suspended
with sleep/suspend method. And while python's coroutines can be sent
values with 'send' method at anytime, with asyncoro, that is not very
useful, as coroutines don't stop at each yield. Instead, with
asyncoro, the correct way to synchronize for data exchange is for
receiving coroutine to suspend and for the sending coroutine to resume
sleeping coroutine with the value.
</p>

<p>
With asyncoro's 'sleep'/'suspend' and 'wakeup'/'resume' methods,
coroutines can send/receive values to/from each other at deliberate
locations, and with 'yield' statements cooperate scheduling their
execution (play relay race).
</p>

<p>
See discopy files for details/examples on how to use asyncoro.
</p>

      </div> 
    </div> 
    <div id="ft"> 
<p>
<!-- Piwik -->
<script type="text/javascript">
  var pkBaseURL = (("https:" == document.location.protocol) ? "https://sourceforge.net/apps/piwik/dispy/" : "http://sourceforge.net/apps/piwik/dispy/");
  document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
  </script><script type="text/javascript">
  try {
  var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
  piwikTracker.trackPageView();
  piwikTracker.enableLinkTracking();
  } catch( err ) {}
  </script><noscript><p><img src="http://sourceforge.net/apps/piwik/dispy/piwik.php?idsite=1" style="border:0" alt=""/></p></noscript>
<!-- End Piwik Tag -->
</p>

      <p> 
        <a href="http://sourceforge.net/"> 
          Project Web Hosted by <img src="http://sflogo.sourceforge.net/sflogo.php?group_id=539226&amp;type=3" alt="SourceForge.net" /> 
        </a> 
      </p> 
      <p> 
        &copy;Copyright 1999-2009 -
        <a href="http://geek.net" title="Network which provides and promotes Open Source software downloads, development, discussion and news."> 
          Geeknet</a>, Inc., All Rights Reserved
      </p> 
      <p> 
        <a href="http://sourceforge.net/about"> 
          About
        </a> 
        -
        <a href="http://sourceforge.net/tos/tos.php"> 
          Legal
        </a> 
        -
        <a href="http://p.sf.net/sourceforge/getsupport"> 
          Help
        </a> 
      </p> 
    </div> 
  </body> 
</html> 
